classdef Sensors
    
    properties(SetAccess = public)
        
        
        
    end
    
    properties(SetAccess = private)
        
        % Cell array of sensor addresses 
        addrs
        
        % Cell array of sensor serial ports 
        ports
        
        
        
    end
    
    methods
        
        function obj = Sensors(NUM_RECEIVERS)
            delete(instrfindall) % For good measure
            
%             1st sensor is back left corner of vehicle
%             Count counterclockwise
            
            %%%%%%%%%%%%%%%%%% INSERT ADDR ORDER HERE %%%%%%%%%%%%%%%%%%
            % Get addr order by running ????
            
%             addrs{1} = '/dev/tty.usbserial-DN00D3MA';
%             addrs{2} = '/dev/tty.usbserial-DN00D2RN';
%             addrs{3} = '/dev/tty.usbserial-DN00CSPC';
%             addrs{4} = '/dev/tty.usbserial-DN00B9FJ';
%             addrs{5} = '/dev/tty.usbserial-DN00D41X';
%             addrs{6} = '/dev/tty.usbserial-DN00CVZK';
            
            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
            
            assert(size(addrs) == NUM_RECEIVERS, 'size(addrs) != NUM_RECEIVERS');
            
            disp('Opening receivers')
            
%             for i = 1:NUM_RECEIVERS
%                 ports{i} = serial(addrs{i}, 'BaudRate', 115200);
%                 foepn(ports{i});
%                 set(ports{i}, 'Timeout', 2);
%             end
            
            ports = serial(addrs, 'BaudRate', 115200);
            foepn(ports);
            set(ports, 'Timeout', 2);
            
            trash = cell(NUM_RECEIVERS, 1);

            for t = 1:5 % Clearing startup glitches
%                 for i = 1:NUM_RECEIVERS
% 
%                     fwrite(ports{i}, 'A');
%                     %trash = fscanf(ports{i}, '%d');
%                     trash{i} = fscanf(ports{i}, '%d');
% 
%                 end

                fwrite(ports, 'A');
                trash = fscanf(ports, '%d');
                
            end

            disp(class(cell2mat(trash)));
            disp(cell2mat(trash));

            disp('done with trash, should be good to run')
            
            
        end
        
        function reading = getReading()
            
            
            
            
        end
        
        
    end
    
    
    
end